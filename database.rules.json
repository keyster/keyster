{
  "rules": {
    "users": {
      "$uid": {
        ".validate": "newData.hasChildren(['settings'])",
        "settings": {
          ".read": "$uid === auth.uid",
          ".write": "$uid === auth.uid",
          ".validate": "newData.hasChildren(['alphabet', 'length', 'N', 'p', 'r'])",
          "alphabet": {
            ".validate": "newData.isString() && newData.val().length <= 150"
          },
          "length": {
            ".validate": "newData.isNumber() && newData.val() <= 150"
          },
          "N": {
            ".validate": "newData.isNumber()"
          },
          "p": {
            ".validate": "newData.isNumber()"
          },
          "r": {
            ".validate": "newData.isNumber()"
          },
          "$other": {
            ".validate": "false"
          }
        },
        "services": {
          ".read": "$uid === auth.uid",
          ".write": "$uid === auth.uid",
          "$id": {
            ".validate": "newData.hasChildren(['title', 'subtitle', 'description', 'salt', 'alphabet', 'length', 'N', 'p', 'r'])",
            "title": {
              ".validate": "newData.isString() && newData.val().length <= 500"
            },
            "subtitle": {
              ".validate": "newData.isString() && newData.val().length <= 100"
            },
            "description": {
              ".validate": "newData.isString() && newData.val().length <= 200"
            },
            "salt": {
              ".validate": "newData.isString() && newData.val().length <= 100"
            },
            "alphabet": {
              ".validate": "newData.isString() && newData.val().length <= 256"
            },
            "length": {
              ".validate": "newData.isNumber() && newData.val() <= 100"
            },
            "N": {
              ".validate": "newData.isNumber()"
            },
            "p": {
              ".validate": "newData.isNumber()"
            },
            "r": {
              ".validate": "newData.isNumber()"
            },
            "$other": {
              ".validate": "false"
            }
          }
        },
        "archive": {
          ".read": "$uid === auth.uid",
          "$id": {
            "title": {},
            "subtitle": {},
            "description": {},
            "salt": {},
            "alphabet": {},
            "length": {},
            "N": {},
            "p": {},
            "r": {},
            "$other": {
              ".validate": "false"
            }
          },
          "$other": {
            ".validate": "false"
          }
        },
        "$other": {
          ".validate": "false"
        }
      }
    }
  }
}
